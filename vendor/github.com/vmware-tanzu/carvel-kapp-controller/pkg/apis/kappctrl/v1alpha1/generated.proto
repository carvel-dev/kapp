
// This file was autogenerated by go-to-protobuf. Do not edit it manually!

syntax = 'proto2';

package github.com.vmware_tanzu.carvel_kapp_controller.pkg.apis.kappctrl.v1alpha1;

import "github.com/vmware-tanzu/carvel-vendir/pkg/vendir/versions/v1alpha1/generated.proto";
import "k8s.io/apimachinery/pkg/apis/meta/v1/generated.proto";
import "k8s.io/apimachinery/pkg/runtime/generated.proto";
import "k8s.io/apimachinery/pkg/runtime/schema/generated.proto";

// Package-wide variables from generator "generated".
option go_package = "v1alpha1";

// +k8s:openapi-gen=true
message AppCluster {
  // +optional
  optional string namespace = 1;

  // +optional
  optional AppClusterKubeconfigSecretRef kubeconfigSecretRef = 2;
}

// +k8s:openapi-gen=true
message AppClusterKubeconfigSecretRef {
  // +optional
  optional string name = 1;

  // +optional
  optional string key = 2;
}

// TODO rename to Condition
// +k8s:openapi-gen=true
message AppCondition {
  optional string type = 1;

  optional string status = 2;

  // Unique, this should be a short, machine understandable string that gives the reason
  // for condition's last transition. If it reports "ResizeStarted" that means the underlying
  // persistent volume is being resized.
  // +optional
  optional string reason = 3;

  // Human-readable message indicating details about last transition.
  // +optional
  optional string message = 4;
}

// +k8s:openapi-gen=true
message AppDeploy {
  optional AppDeployKapp kapp = 1;
}

// +k8s:openapi-gen=true
message AppDeployKapp {
  optional string intoNs = 1;

  repeated string mapNs = 2;

  repeated string rawOptions = 3;

  optional AppDeployKappInspect inspect = 4;

  optional AppDeployKappDelete delete = 5;
}

// +k8s:openapi-gen=true
message AppDeployKappDelete {
  repeated string rawOptions = 1;
}

// +k8s:openapi-gen=true
message AppDeployKappInspect {
  repeated string rawOptions = 1;
}

// +k8s:openapi-gen=true
message AppFetch {
  optional AppFetchInline inline = 1;

  optional AppFetchImage image = 2;

  optional AppFetchHTTP http = 3;

  optional AppFetchGit git = 4;

  optional AppFetchHelmChart helmChart = 5;

  optional AppFetchImgpkgBundle imgpkgBundle = 6;
}

// TODO implement git
// +k8s:openapi-gen=true
message AppFetchGit {
  optional string url = 1;

  // +optional
  optional string ref = 2;

  // +optional
  optional github.com.vmware_tanzu.carvel_vendir.pkg.vendir.versions.v1alpha1.VersionSelection refSelection = 6;

  // Secret may include one or more keys: ssh-privatekey, ssh-knownhosts
  // +optional
  optional AppFetchLocalRef secretRef = 3;

  // +optional
  optional string subPath = 4;

  // +optional
  optional bool lfsSkipSmudge = 5;
}

// +k8s:openapi-gen=true
message AppFetchHTTP {
  // URL can point to one of following formats: text, tgz, zip
  optional string url = 1;

  // +optional
  optional string sha256 = 2;

  // Secret may include one or more keys: username, password
  // +optional
  optional AppFetchLocalRef secretRef = 3;

  // +optional
  optional string subPath = 4;
}

// +k8s:openapi-gen=true
message AppFetchHelmChart {
  // Example: stable/redis
  optional string name = 1;

  // +optional
  optional string version = 2;

  optional AppFetchHelmChartRepo repository = 3;
}

// +k8s:openapi-gen=true
message AppFetchHelmChartRepo {
  optional string url = 1;

  // +optional
  optional AppFetchLocalRef secretRef = 2;
}

// +k8s:openapi-gen=true
message AppFetchImage {
  // Example: username/app1-config:v0.1.0
  optional string url = 1;

  // +optional
  optional github.com.vmware_tanzu.carvel_vendir.pkg.vendir.versions.v1alpha1.VersionSelection tagSelection = 4;

  // Secret may include one or more keys: username, password, token.
  // By default anonymous access is used for authentication.
  // TODO support docker config formated secret
  // +optional
  optional AppFetchLocalRef secretRef = 2;

  // +optional
  optional string subPath = 3;
}

// +k8s:openapi-gen=true
message AppFetchImgpkgBundle {
  optional string image = 1;

  // +optional
  optional github.com.vmware_tanzu.carvel_vendir.pkg.vendir.versions.v1alpha1.VersionSelection tagSelection = 3;

  // Secret may include one or more keys: username, password, token.
  // By default anonymous access is used for authentication.
  // TODO support docker config formated secret
  // +optional
  optional AppFetchLocalRef secretRef = 2;
}

// +k8s:openapi-gen=true
message AppFetchInline {
  map<string, string> paths = 1;

  repeated AppFetchInlineSource pathsFrom = 2;
}

// +k8s:openapi-gen=true
message AppFetchInlineSource {
  optional AppFetchInlineSourceRef secretRef = 1;

  optional AppFetchInlineSourceRef configMapRef = 2;
}

// +k8s:openapi-gen=true
message AppFetchInlineSourceRef {
  optional string directoryPath = 2;

  optional string name = 1;
}

// +k8s:openapi-gen=true
message AppFetchLocalRef {
  // Object is expected to be within same namespace
  optional string name = 1;
}

// +k8s:openapi-gen=true
message AppSpec {
  // +optional
  optional string serviceAccountName = 1;

  // +optional
  optional AppCluster cluster = 2;

  // +optional
  repeated AppFetch fetch = 3;

  // +optional
  repeated AppTemplate template = 4;

  // +optional
  repeated AppDeploy deploy = 5;

  // Paused when set to true will ignore all pending changes,
  // once it set back to false, pending changes will be applied
  // +optional
  optional bool paused = 6;

  // Canceled when set to true will stop all active changes
  // +optional
  optional bool canceled = 7;

  // Controls frequency of app reconciliation
  // +optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Duration syncPeriod = 8;

  // When NoopDeletion set to true, App deletion should
  // delete App CR but preserve App's associated resources
  // +optional
  optional bool noopDelete = 9;
}

// +k8s:openapi-gen=true
message AppTemplate {
  optional AppTemplateYtt ytt = 1;

  optional AppTemplateKbld kbld = 2;

  optional AppTemplateHelmTemplate helmTemplate = 3;

  optional AppTemplateKustomize kustomize = 4;

  optional AppTemplateJsonnet jsonnet = 5;

  optional AppTemplateSops sops = 6;
}

// +k8s:openapi-gen=true
message AppTemplateHelmTemplate {
  optional string name = 1;

  optional string namespace = 2;

  optional string path = 3;

  repeated AppTemplateValuesSource valuesFrom = 4;
}

// TODO implement jsonnet
// +k8s:openapi-gen=true
message AppTemplateJsonnet {
}

// +k8s:openapi-gen=true
message AppTemplateKbld {
  repeated string paths = 1;
}

// TODO implement kustomize
// +k8s:openapi-gen=true
message AppTemplateKustomize {
}

// +k8s:openapi-gen=true
message AppTemplateSops {
  optional AppTemplateSopsPGP pgp = 1;

  repeated string paths = 2;
}

// +k8s:openapi-gen=true
message AppTemplateSopsPGP {
  optional AppTemplateSopsPGPPrivateKeysSecretRef privateKeysSecretRef = 1;
}

// +k8s:openapi-gen=true
message AppTemplateSopsPGPPrivateKeysSecretRef {
  optional string name = 1;
}

// +k8s:openapi-gen=true
message AppTemplateValuesSource {
  optional AppTemplateValuesSourceRef secretRef = 1;

  optional AppTemplateValuesSourceRef configMapRef = 2;

  optional string path = 3;
}

// +k8s:openapi-gen=true
message AppTemplateValuesSourceRef {
  optional string name = 1;
}

// +k8s:openapi-gen=true
message AppTemplateYtt {
  optional bool ignoreUnknownComments = 1;

  optional bool strict = 2;

  optional AppFetchInline inline = 3;

  repeated string paths = 4;

  repeated string fileMarks = 5;

  repeated AppTemplateValuesSource valuesFrom = 6;
}

message GenericStatus {
  // +optional
  optional int64 observedGeneration = 1;

  // +optional
  repeated AppCondition conditions = 2;

  // +optional
  optional string friendlyDescription = 3;

  // +optional
  optional string usefulErrorMessage = 4;
}

